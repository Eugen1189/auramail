# üö® –®–≤–∏–¥–∫–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ run_task_in_context

## –ü—Ä–æ–±–ª–µ–º–∞
```
ValueError: Invalid attribute name: run_task_in_context
```

–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤ Redis —á–µ—Ä–∑—ñ –∑–∞–ª–∏—à–∏–ª–∏—Å—è —Å—Ç–∞—Ä—ñ –∑–∞–¥–∞—á—ñ –∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º –Ω–∞ –≤–∏–¥–∞–ª–µ–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é.

## ‚úÖ –®–≤–∏–¥–∫–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è (3 –∫—Ä–æ–∫–∏)

### –ö—Ä–æ–∫ 1: –ó—É–ø–∏–Ω–∏—Ç–∏ Worker
–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å `Ctrl+C` —É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ, –¥–µ –∑–∞–ø—É—â–µ–Ω–∏–π worker.

### –ö—Ä–æ–∫ 2: –û—á–∏—Å—Ç–∏—Ç–∏ —á–µ—Ä–≥—É Redis

**–í–∞—Ä—ñ–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ Python (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)**

–í—ñ–¥–∫—Ä–∏–π—Ç–µ Python REPL:
```powershell
python
```

–ü–æ—Ç—ñ–º –≤–∏–∫–æ–Ω–∞–π—Ç–µ:
```python
import redis
from rq import Queue

conn = redis.from_url('redis://localhost:6379/0')
q = Queue('default', connection=conn)

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–¥–∞—á
print(f"Jobs in queue: {len(q)}")

# –û—á–∏—Å—Ç–∏—Ç–∏ —á–µ—Ä–≥—É
q.empty()
print("‚úÖ Queue cleared!")

# –û—á–∏—Å—Ç–∏—Ç–∏ failed jobs
from rq.registry import FailedJobRegistry
failed = FailedJobRegistry('default', connection=conn)
for job_id in failed.get_job_ids():
    failed.remove(job_id)
print("‚úÖ Failed jobs cleared!")

# –û—á–∏—Å—Ç–∏—Ç–∏ started jobs
from rq.registry import StartedJobRegistry
started = StartedJobRegistry('default', connection=conn)
for job_id in started.get_job_ids():
    started.remove(job_id)
print("‚úÖ Started jobs cleared!")

exit()
```

**–í–∞—Ä—ñ–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç**

```powershell
python clear_queue_simple.py
```

**–í–∞—Ä—ñ–∞–Ω—Ç C: –ß–µ—Ä–µ–∑ redis-cli (—è–∫—â–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)**

```bash
redis-cli
> FLUSHDB
> exit
```

‚ö†Ô∏è **–£–≤–∞–≥–∞**: `FLUSHDB` –≤–∏–¥–∞–ª–∏—Ç—å –í–°–Ü –¥–∞–Ω—ñ –∑ Redis, –Ω–µ —Ç—ñ–ª—å–∫–∏ RQ —á–µ—Ä–≥—É!

### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ Worker
```powershell
python worker.py
```

## ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

–ü—ñ—Å–ª—è –æ—á–∏—â–µ–Ω–Ω—è —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–æ–≤—É –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ `/sort` –º–∞—Ä—à—Ä—É—Ç. –í–æ–Ω–∞ –º–∞—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `background_sort_task` –Ω–∞–ø—Ä—è–º—É —ñ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –±–µ–∑ –ø–æ–º–∏–ª–æ–∫.

## üîç –ß–æ–º—É —Ü–µ —Å—Ç–∞–ª–æ—Å—è?

–ü—ñ—Å–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó `run_task_in_context` —Å—Ç–∞—Ä—ñ –∑–∞–¥–∞—á—ñ –≤ —á–µ—Ä–∑—ñ Redis –≤—Å–µ —â–µ –º–∞—é—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é. RQ –Ω–µ –º–æ–∂–µ –∑–Ω–∞–π—Ç–∏ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é, —Ç–æ–º—É –≤–∏–Ω–∏–∫–∞—î –ø–æ–º–∏–ª–∫–∞.

## üí° –ü—Ä–æ—Ñ—ñ–ª–∞–∫—Ç–∏–∫–∞

–ü—ñ—Å–ª—è –∑–º—ñ–Ω —É –∫–æ–¥—ñ, —è–∫—ñ –∑–∞—á—ñ–ø–∞—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–¥–∞—á RQ:
1. –ó–∞–≤–∂–¥–∏ –æ—á–∏—â–∞–π—Ç–µ —á–µ—Ä–≥—É –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è–º
2. –ê–±–æ –¥–æ—á–µ–∫–∞–π—Ç–µ—Å—è, –ø–æ–∫–∏ –≤—Å—ñ —Å—Ç–∞—Ä—ñ –∑–∞–¥–∞—á—ñ –±—É–¥—É—Ç—å –æ–±—Ä–æ–±–ª–µ–Ω—ñ/–ø–æ–º–∏–ª–∫–æ–≤—ñ
3. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –≤–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π –∑–∞–¥–∞—á (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `background_sort_task_v2`)

